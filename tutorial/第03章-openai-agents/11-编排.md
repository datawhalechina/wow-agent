# 多智能体编排
编排（Orchestration）指的是应用程序中智能体的运行流程。哪些智能体执行任务、以何种顺序执行、以及如何决定后续操作？目前主要有两种智能体编排方式：

让大模型自主决策：利用大模型的智能进行规划、推理并决定执行步骤
通过代码编排：用代码控制智能体的执行流程
这两种模式可以混合使用，各自存在不同的优劣点，下文将详细说明。

### 大模型自主编排模式
智能体是配备了指令、工具和任务移交机制的大模型。这意味着面对开放式任务时，大模型能够自主规划解决方案：使用工具执行操作获取数据，通过移交机制将任务分配给子智能体。例如，一个研究型智能体可配备以下工具：

网络搜索工具获取在线信息
文件检索工具查询专有数据
计算机操作工具执行本地操作
代码执行工具进行数据分析
任务移交机制委托给擅长规划、报告撰写等专项智能体
这种模式非常适合开放式任务场景，能充分发挥大模型的智能优势。关键实施策略包括：

精心设计提示词：明确可用工具、使用方式及操作边界
持续监控与迭代：分析故障点并优化提示词
引入自省机制：例如循环执行时让智能体自我评估，或根据错误信息自我修正
采用专项智能体：而非期待通用智能体胜任所有任务
建立评估体系：通过evals持续训练提升智能体表现



### 代码化编排模式
虽然大模型自主编排能力强大，但代码化编排能在执行速度、成本控制和性能表现方面提供更确定性的结果。常见实现模式包括：

使用结构化输出：生成规范数据供代码逻辑判断，例如先让智能体对任务分类，再根据类别选择后续智能体
构建处理链：将任务分解为串联的智能体流水线，比如博客写作可拆分为研究->大纲->撰写->润色->改进等环节
实现评估循环：在while循环中，执行智能体与评估智能体持续交互，直到输出满足预设标准
并行执行机制：通过asyncio.gather等Python原生方式并行运行多个智能体，适用于无依赖关系的批量任务加速